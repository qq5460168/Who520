#############################################
# 配置作用：本配置为全局配置文件，内含去广告，应用分流，策略组，定时脚本等
# 重要提示：导入本文件会覆盖原本所有配置，不是初次配置QuanX请谨慎使用
# 注意事项: 以下内容中，带“;” “#” “//” 开头的行都是注释，去掉注释符号该行才有效
# 项目地址、配置教程、交流群组、更新时间等信息见下方
#############################################

# 建议添加以下数据库，用于IP归属地识别，提升分流准确性
# https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb
# 使用方法：QuantumultX-风车-其他设置-GeoLite2-来源，填入上方链接

# ==========【通用设置】==========
[general]
# Quantumult X 会用此URL检测每个节点是否可用，提高节点管理效率
server_check_url=http://cp.cloudflare.com/generate_204

# 节点检测超时时长，单位毫秒，3000即3秒，超过则视为超时
server_check_timeout = 3000

# 配置文件头像显示，可自定义美观
profile_img_url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/author/fmz200-01.png

# 下列域名不会采用 fake-ip 模式，避免个别站点兼容性问题
dns_exclusion_list=*.cmpassport.com, *.jegotrip.com.cn, *.icitymobile.mobi, id6.me, *.pingan.com.cn, *.cmbchina.com

# 节点信息展示，顶部展示节点地理位置
geo_location_checker=http://ip-api.com/json/?lang=zh-CN, https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/scripts/server_location.js

# 资源解析器脚本地址，用于转换/解析远程资源（如节点/规则等）
resource_parser_url=https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/resource-parser.js

# 指定不经QuantumultX处理的IP段，常用于组播/本地服务
excluded_routes=239.255.255.250/32

# UDP回落策略，指定遇到不支持UDP转发时的处理方式（如v1.0.19+支持）
fallback_udp_policy=direct

# 指定UDP丢弃端口名单，被丢弃端口不会返回ICMP错误
udp_drop_list=443

# ==========【DNS设置】==========
[dns]
# 禁用IPv6解析，防止因IPv6引发的连接问题
no-ipv6

# 默认DNS服务器，常用的公共DNS（腾讯DNS）
server=119.29.29.29

# 指定域名的固定IP解析，通常用于加速或解锁指定服务
address=/mtalk.google.com/108.177.125.188

# 指定域名用指定DNS服务器解析
server=/dl.google.com/119.29.29.29
server=/dl.l.google.com/119.29.29.29
server=/tplogin.cn/system
server=/tplinklogin.net/system
server=/melogin.cn/system
server=/falogin.cn/system

# 指定DoH（DNS over HTTPS）加密DNS服务器，提升隐私
doh-server=https://lyq.916899380.xyz:8711/dns-query

;如上方指定了doh-server，则普通DNS配置失效。可通过excluded_ssids指定WiFi下禁用DoH
;doh-server=xxx.com, excluded_ssids=SSID1, SSID2

;指定DoH请求用的User-Agent头
;doh_user_agent=Agent/1.0

# ==========【策略组设置】==========
[policy]
# static策略组：用户手动选择用哪个节点，后跟节点组名和图标
static=海外抖音, proxy, 香港节点, 日本节点, 狮城节点, 台湾节点, 美国节点, img-url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/tiktok.png
static=谷歌服务, proxy, 香港节点, 日本节点, 狮城节点, 台湾节点, 美国节点, img-url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/Google.png
static=电报消息, proxy, 香港节点, 日本节点, 狮城节点, 台湾节点, 美国节点, img-url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/telegram.png
static=Spotify, proxy, 香港节点, 日本节点, 狮城节点, 台湾节点, 美国节点, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Spotify.png
static=人工智能, proxy, 美国节点, 狮城节点, img-url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/OpenAI.png
static=苹果服务, direct, proxy, 香港节点, 日本节点, 狮城节点, 台湾节点, 美国节点, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/Apple.png
static=兜底策略, direct, proxy, 香港节点, 台湾节点, 日本节点, 狮城节点, 美国节点, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png

# url-latency-benchmark策略组：自动选择延迟最低节点，server-tag-regex用于筛选节点名
url-latency-benchmark=香港节点, server-tag-regex=港|HK|Hong|🇭🇰, check-interval=600, tolerance=0, alive-checking=false, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/HK.png
url-latency-benchmark=日本节点, server-tag-regex=日|JP|Japan|🇯🇵, check-interval=600, tolerance=0, alive-checking=false, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/JP.png
url-latency-benchmark=狮城节点, server-tag-regex=新加坡|狮|獅|SG|Singapore|🇸🇬, check-interval=600, tolerance=0, alive-checking=false, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/SG.png
url-latency-benchmark=美国节点, server-tag-regex=美|US|States|American|🇺🇸, check-interval=600, tolerance=0, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/US.png
url-latency-benchmark=韩国节点, server-tag-regex=韩|KR|Korea|🇰🇷, check-interval=600, tolerance=0, alive-checking=false, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/KR.png
url-latency-benchmark=台湾节点, server-tag-regex=台|TW|Taiwan, check-interval=600, tolerance=0, alive-checking=false, img-url=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/QuantumultX/icon/tw.png

# ==========【本地服务器设置】==========
[server_local]
# 此处可填写自建本地节点配置，常用于自定义代理节点

# ==========【远程订阅设置】==========
[server_remote]
# 远程节点订阅链接，tag为备注名，update-interval为自动更新周期（秒），enabled控制是否启用
https://edu.dianping.men/iv/verify_mode.htm?token=8d48d24d5363b2c9b67b3fe7ddc5e802, tag=Tag-1751772908, update-interval=172800, opt-parser=false, enabled=true
https://let.bnsubservdom.com/api/v1/client/subscribe?token=f43a89e59da60a5d5dd088547ee0df78, tag=Tag-1751772894, update-interval=172800, opt-parser=true, enabled=true
https://pear.besnow.uk/api/v1/client/subscribe?token=bc89b545139c7a2cddadffa194d165ef, tag=Tag-1751772870, update-interval=172800, opt-parser=false, enabled=true
https://sub3.smallstrawberry.com/api/v1/client/subscribe?token=e1571f1f4af54c76b1fa3fa2201d5645, tag=一元机场, update-interval=172800, opt-parser=false, enabled=false

# ==========【本地分流规则】==========
[filter_local]
# 局域网和本地回环流量不走代理
host-suffix, local, direct
ip-cidr, 192.168.0.0/16, direct
ip-cidr, 10.0.0.0/8, direct
ip-cidr, 172.16.0.0/12, direct
ip-cidr, 127.0.0.0/8, direct
ip-cidr, 100.64.0.0/10, direct
ip-cidr, 224.0.0.0/4, direct
ip-cidr, 183.240.197.130/32, direct
ip6-cidr, fe80::/10, direct

# 苹果播客相关流量走代理
host-keyword, amp-api.podcasts.apple.com, proxy

# geoip规则，所有中国大陆IP直连
geoip, cn, direct

# 所有未被上面规则匹配的流量，交给“兜底策略”处理
final, 兜底策略

# ==========【远程分流规则订阅】==========
[filter_remote]
# 远程分流规则，tag为备注，force-policy可强制指定流量走哪个策略组
https://github.com/fmz200/wool_scripts/raw/main/QuantumultX/filter/filter.list, tag=广告拦截合集@fmz200, update-interval=604800, opt-parser=false, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/rule/AI.list, tag=AI分流规则合集@fmz200, force-policy=人工智能, update-interval=172800, opt-parser=true, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/QuantumultX/filter/soul.list, tag=Soul分流@fmz200, force-policy=direct, update-interval=86400, opt-parser=false, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/QuantumultX/filter/talkatone.list, tag=talkatone分流@fmz200, force-policy=美国节点, update-interval=86400, opt-parser=false, enabled=true
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/QuantumultX/TikTok/TikTok.list, tag=TikTok@bm7, force-policy=海外抖音, update-interval=86400, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Telegram/Telegram.list, tag=Telegram@bm7, force-policy=电报消息, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Google/Google.list, tag=Google@bm7, force-policy=谷歌服务, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Spotify/Spotify.list, tag=Spotify@bm7, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/GitHub/GitHub.list, tag=Github@bm7, force-policy=proxy, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/qq5460168/666/refs/heads/master/qx.list, tag=自定义分流@qq5460168, update-interval=86400, opt-parser=false, enabled=true

# ==========【本地重写规则】==========
[rewrite_local]
# 哔哩哔哩大会员特权领取cookie，脚本用于自动获取请求头中的cookie
https:\/\/api.bilibili.com\/x\/vip\/privilege\/receive url script-request-header https://raw.githubusercontent.com/lowking/Scripts/master/bilibili/privilegeReceive.js

# 喜马拉雅app登录自动获取cookie
#^https?:\/\/.*\/mobile\-user\/v2\/homePage\/.* url script-request-header https://raw.githubusercontent.com/chavyleung/scripts/master/ximalaya/ximalaya.cookie.js

# ==========【远程重写规则订阅】==========
[rewrite_remote]
# 远程重写规则，tag为备注，enabled控制是否启用
# 会员解锁、广告净化、功能增强、网页优化等脚本，分门别类
https://raw.githubusercontent.com/Orz-3/QuantumultX/master/JS_GetCookie.conf, tag=获取ck, update-interval=172800, opt-parser=false, enabled=false
https://raw.githubusercontent.com/githubdulong/Script/master/QuantumultX/Cookie.conf, tag=获取Ck two, update-interval=172800, opt-parser=false, enabled=false
https://raw.githubusercontent.com/zwf234/rules/master/getCookie.conf, tag=获取Cookie（获取完就禁用）, update-interval=86400, opt-parser=false, enabled=false
https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/rewrite/weibo.snippet, tag=微博去广告@fmz200, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/rewrite/chongxie.txt, tag=广告拦截合集@fmz200, update-interval=604800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/rewrite/cookies.snippet, tag=获取cookie合集@fmz200, update-interval=604800, opt-parser=false, enabled=false
https://raw.githubusercontent.com/app2smile/rules/master/module/spotify.conf, tag=Spotify音乐VIP@app2smile, update-interval=172800, opt-parser=false, enabled=true
https://github.com/chavyleung/scripts/raw/master/box/rewrite/boxjs.rewrite.quanx.conf, tag=BoxJs 稳定版, update-interval=172800, opt-parser=false, enabled=true
https://github.com/sub-store-org/Sub-Store/raw/master/config/QX.snippet, tag=Sub-Store, update-interval=172800, opt-parser=false, enabled=true

# ======= 会员解锁 ======= #
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/BilibiliAdsLite.conf, tag=哔哩哔哩广告净化@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/dev/raw/master/ForOwnUse.conf, tag=墨鱼专属VIP@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true

# ======= 广告净化 ======= #
https://gist.githubusercontent.com/ddgksf2013/12ef6aad209155e7eb62c5b00c11b9dd/raw/StartUpAds.conf, tag=墨鱼去开屏2.0@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/CaiYunAds.conf, tag=彩云天气净化@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://gist.githubusercontent.com/ddgksf2013/d43179d848586d561dbb968dee93bae8/raw/Zhihu.Adblock.js, tag=知乎净化助手@ddgksf2013, update-interval=86400, opt-parser=true, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/YoutubeAds.conf, tag=油管去广告@Maasea, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Weibo.conf, tag=微博去广告@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Ximalaya.conf, tag=喜马拉雅去广告[卸载重装]@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Amap.conf, tag=高德地图净化[卸载重装]@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/NeteaseAds.conf, tag=网易云净化@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/Applet.conf, tag=微信小程序去广告@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true

# ======= 网页优化 ======= #
https://github.com/ddgksf2013/Rewrite/raw/master/Html/Q-Search.conf, tag=Safari超级搜索@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/Html/Douban.conf, tag=豆瓣网页观影快捷跳转@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://github.com/ddgksf2013/Rewrite/raw/master/Html/General.conf, tag=Google重定向@DivineEngine, update-interval=86400, opt-parser=false, enabled=true

# ======= 功能增强 ======= #
https://github.com/ddgksf2013/Rewrite/raw/master/AdBlock/XiaoHongShuAds.conf, tag=小红书净化+去水印@ddgksf2013, update-interval=86400, opt-parser=false, enabled=true
https://gist.githubusercontent.com/ddgksf2013/f43026707830c7818ee3ba624e383c8d/raw/baiduCloud.adblock.js, tag=百度网盘净化@ddgksf2013, update-interval=86400, opt-parser=true, enabled=true
https://raw.githubusercontent.com/ddgksf2013/Rewrite/master/Function/UnblockURLinWeChat.conf, tag=微信解锁被屏蔽的URL@zZPiglet, update-interval=86400, opt-parser=false, enabled=true

# ==========【定时任务模块】==========
[task_local]
# 每日0点自动签到，tag为备注
1 0 * * * https://raw.githubusercontent.com/chavyleung/scripts/master/tieba/tieba.js, tag=百度签到, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/baidu.png, enabled=true
1 0 * * * https://raw.githubusercontent.com/chavyleung/scripts/master/ximalaya/ximalaya.js, tag=喜马拉雅, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/ximalaya.png, enabled=true
1 0 * * * https://raw.githubusercontent.com/chavyleung/scripts/master/meituan/meituan.js, tag=美团, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/meituan.png, enabled=true
1 0 * * * https://raw.githubusercontent.com/chavyleung/scripts/master/bilibili/bilibili.js, tag=bilibili, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/bilibili.png, enabled=true

# UI交互检测任务
event-interaction https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/streaming-ui-check.js, tag=流媒体-解锁查询, img-url=checkmark.seal.system, enabled=true
event-interaction https://raw.githubusercontent.com/I-am-R-E/Functional-Store-Hub/Master/NodeLinkCheck/Script/NodeLinkCheck.js, tag=Env代理链路检测, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png, enabled=true
event-interaction https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/scripts/server_info.js, tag=节点详情查询, img-url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/OpenAI.png, enabled=true

# 爱奇艺会员签到
0 9 * * * https://raw.githubusercontent.com/NobyDa/Script/master/iQIYI-DailyBonus/iQIYI.js,  tag=爱奇艺,
5 9 * * * https://raw.githubusercontent.com/chavyleung/scripts/master/ximalaya/ximalaya.js, tag=喜马拉雅, img-url=https://raw.githubusercontent.com/Orz-3/task/master/ximalaya.png, enabled=true
1 0 * * * https://raw.githubusercontent.com/chavyleung/scripts/master/bilibili/bilibili.js, tag=哔哩哔哩签到, img-url=https://qxzy.top/rules/QuantumultX/img/bilibili.png, enabled=true

# ==========【HTTP后端】==========
[http_backend]
# 备用接口配置（BoxJS新版本已不需要）

;https://raw.githubusercontent.com/chavyleung/scripts/master/chavy.box.js, host=boxjs.com, tag=BoxJS, path=^/, enabled=true

# ==========【MITM中间人证书设置】==========
[mitm]
# hostname：需要进行https解密的主机名，-开头表示排除
hostname = -www.google.com, -*.amemv.com, -*.snssdk.com, boxjs.net, boxjs.com,heisekeji.cn, open.meituan.com, open.meituan.com, account.wps.cn, me-api.jd.com, me-api.jd.com, passport.iqiyi.com, api.m.jd.com, ...

# passphrase：证书密码
passphrase = 2F09B436

# p12：中间人证书内容（base64编码，一般自动生成，无需手动更改）
p12 = MIILuQIBAzCCC4MGCSqGSIb3DQEHAaCCC3QEggtwMIILbDCCBccGCSqGSIb3DQEHBqCCBbgwggW0AgEAMIIFrQYJKoZIhvcNAQcBMBwGCiqGSIb3DQEMAQYwDgQIFKAp2W8x72cCAggAgIIFgFleJhekTgseKEVgN3rLoOVE1TLVgnQTPXBIUnbomI9Z2fwJA+[...]

# 跳过证书有效性验证，避免自签证书无法使用的问题
skip_validating_cert = true
